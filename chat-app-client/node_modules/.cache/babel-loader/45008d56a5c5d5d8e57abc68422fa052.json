{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/\\u05E0\\u05E8\\u05D9\\u05D4/Desktop/Chat Rooms App/chatRoomsFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/\\u05E0\\u05E8\\u05D9\\u05D4/Desktop/Chat Rooms App/chatRoomsFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useEffect,useContext}from\"react\";import{useDispatch}from\"react-redux\";import{AuthContext}from'../Components/AuthContext';import Loader from\"./Loader\";import{updateTokens}from\"../DAL/authenticationApi\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Initialization(){var ctx=useContext(AuthContext);var dispatch=useDispatch();var login=function login(){dispatch({type:'LOGIN'});};var logout=function logout(){dispatch({type:'LOGOUT'});};var start=function start(){dispatch({type:'START'});};useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$updateTokens,accessToken;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return updateTokens();case 2:_yield$updateTokens=_context.sent;accessToken=_yield$updateTokens.accessToken;if(accessToken){login();ctx.refreshToken(accessToken);}else{logout();}setTimeout(function(){start();},350);case 6:case\"end\":return _context.stop();}}},_callee);}))();},[]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Loader,{})});}export default Initialization;","map":{"version":3,"sources":["C:/Users/נריה/Desktop/Chat Rooms App/chatRoomsFrontend/src/chat/Components/Initialization.js"],"names":["useEffect","useContext","useDispatch","AuthContext","Loader","updateTokens","Initialization","ctx","dispatch","login","type","logout","start","accessToken","refreshToken","setTimeout"],"mappings":"+XAAA,OAAQA,SAAR,CAAmBC,UAAnB,KAAoC,OAApC,CACA,OAAQC,WAAR,KAA0B,aAA1B,CACA,OAAQC,WAAR,KAA0B,2BAA1B,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,OAAQC,YAAR,KAA2B,0BAA3B,C,gGAGA,QAASC,CAAAA,cAAT,EAAyB,CAErB,GAAMC,CAAAA,GAAG,CAAGN,UAAU,CAACE,WAAD,CAAtB,CAEA,GAAMK,CAAAA,QAAQ,CAAGN,WAAW,EAA5B,CAEA,GAAMO,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,EAAM,CAChBD,QAAQ,CAAC,CAACE,IAAI,CAAE,OAAP,CAAD,CAAR,CACH,CAFD,CAIA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACjBH,QAAQ,CAAC,CAACE,IAAI,CAAE,QAAP,CAAD,CAAR,CACH,CAFD,CAIA,GAAME,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,EAAM,CAChBJ,QAAQ,CAAC,CAACE,IAAI,CAAE,OAAP,CAAD,CAAR,CACH,CAFD,CAIAV,SAAS,CAAC,UAAI,CACV,wDAAC,6LAC+BK,CAAAA,YAAY,EAD3C,0CACUQ,WADV,qBACUA,WADV,CAEG,GAAGA,WAAH,CAAgB,CACZJ,KAAK,GACLF,GAAG,CAACO,YAAJ,CAAiBD,WAAjB,EACH,CAHD,IAGO,CACHF,MAAM,GACT,CACDI,UAAU,CAAC,UAAI,CACXH,KAAK,GACR,CAFS,CAEP,GAFO,CAAV,CARH,sDAAD,KAYH,CAbQ,CAaP,EAbO,CAAT,CAeA,mBAAO,sCACH,KAAC,MAAD,IADG,EAAP,CAGH,CAED,cAAeN,CAAAA,cAAf","sourcesContent":["import {useEffect, useContext} from \"react\"\r\nimport {useDispatch} from \"react-redux\"\r\nimport {AuthContext} from '../Components/AuthContext'\r\nimport Loader from \"./Loader\"\r\nimport {updateTokens} from \"../DAL/authenticationApi\"\r\n\r\n\r\nfunction Initialization(){\r\n\r\n    const ctx = useContext(AuthContext)\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const login = () => {\r\n        dispatch({type: 'LOGIN'})\r\n    }\r\n\r\n    const logout = () => {\r\n        dispatch({type: 'LOGOUT'})\r\n    }\r\n\r\n    const start = () => {\r\n        dispatch({type: 'START'})\r\n    }\r\n\r\n    useEffect(()=>{\r\n        (async ()=>{\r\n            const {accessToken} = await updateTokens()\r\n            if(accessToken) {\r\n                login()\r\n                ctx.refreshToken(accessToken)\r\n            } else {\r\n                logout()\r\n            }\r\n            setTimeout(()=>{\r\n                start()\r\n            }, 350)\r\n        })()\r\n    },[])\r\n\r\n    return <>\r\n        <Loader/>\r\n    </>\r\n}\r\n\r\nexport default Initialization"]},"metadata":{},"sourceType":"module"}
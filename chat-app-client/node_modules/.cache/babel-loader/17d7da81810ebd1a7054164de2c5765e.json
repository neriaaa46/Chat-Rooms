{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/\\u05E0\\u05E8\\u05D9\\u05D4/Desktop/chat rooms/chatRoomsFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/\\u05E0\\u05E8\\u05D9\\u05D4/Desktop/chat rooms/chatRoomsFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:/Users/\\u05E0\\u05E8\\u05D9\\u05D4/Desktop/chat rooms/chatRoomsFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/\\u05E0\\u05E8\\u05D9\\u05D4/Desktop/chat rooms/chatRoomsFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Form,Button,Row,Col,Container}from\"react-bootstrap\";import{Link}from\"react-router-dom\";import{useState,useContext}from\"react\";import{useHistory}from\"react-router\";import{useDispatch}from\"react-redux\";import{validation,email,password}from\"../Utils/validation\";import{loginUser}from\"../DAL/authenticationApi\";import{AuthContext}from\"../Components/AuthContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Login(){var history=useHistory();var dispatch=useDispatch();var ctx=useContext(AuthContext);var login=function login(){dispatch({type:'LOGIN'});};var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var _useState3=useState({email:_objectSpread(_objectSpread({},email),{},{inValid:false,value:\"\",error:[]}),password:_objectSpread(_objectSpread({},password),{},{inValid:false,value:\"\",error:[]})}),_useState4=_slicedToArray(_useState3,2),loginInputDetails=_useState4[0],setLoginInputDetails=_useState4[1];function submit(_x){return _submit.apply(this,arguments);}function _submit(){_submit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var isValid,user,key,response,_yield$response$json,accessToken,_message;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();isValid=true;user={};for(key in loginInputDetails){user[key]=loginInputDetails[key].value;setLoginInputDetails(validation({value:loginInputDetails[key].value,name:key},loginInputDetails,\"login\"));if(loginInputDetails[key].errors.length!==0){isValid=false;}}if(!isValid){_context.next=15;break;}_context.next=7;return loginUser(user);case 7:response=_context.sent;_context.next=10;return response.json();case 10:_yield$response$json=_context.sent;accessToken=_yield$response$json.accessToken;_message=_yield$response$json.message;setMessage(_message);if(response.ok){setTimeout(function(){ctx.refreshToken(accessToken);login();history.push('/rooms');},2000);}else{setTimeout(function(){setMessage(\"\");},5000);}case 15:case\"end\":return _context.stop();}}},_callee);}));return _submit.apply(this,arguments);}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Container,{className:\"container-base mt-4\",children:/*#__PURE__*/_jsxs(Form,{className:\"form-base\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-center mt-3 mb-4\",children:\"Login\"}),/*#__PURE__*/_jsxs(Row,{className:\"justify-content-center\",children:[/*#__PURE__*/_jsxs(Col,{xs:11,md:8,lg:6,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"input-base\",children:[/*#__PURE__*/_jsx(Form.Control,{type:\"email\",name:\"email\",isInvalid:loginInputDetails[\"email\"].inValid,placeholder:\"Email\",onBlur:function onBlur(e){setLoginInputDetails(validation(e.target,loginInputDetails,\"login\"));}}),loginInputDetails[\"email\"].errors.map(function(value,index){return/*#__PURE__*/_jsxs(Form.Control.Feedback,{className:\"feedback\",type:\"invalid\",children:[\" \",value,\" \"]},index);})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"input-base\",children:[/*#__PURE__*/_jsx(Form.Control,{type:\"password\",name:\"password\",isInvalid:loginInputDetails[\"password\"].inValid,placeholder:\"Password\",onBlur:function onBlur(e){setLoginInputDetails(validation(e.target,loginInputDetails,\"login\"));}}),loginInputDetails[\"password\"].errors.map(function(value,index){return/*#__PURE__*/_jsxs(Form.Control.Feedback,{className:\"feedback\",type:\"invalid\",children:[\" \",value,\" \"]},index);})]}),/*#__PURE__*/_jsxs(Row,{className:\"btn-link-base mb-3\",children:[/*#__PURE__*/_jsx(Button,{className:\"btn-login\",variant:\"dark\",type:\"submit\",onClick:function onClick(e){submit(e);},children:\"Login\"}),/*#__PURE__*/_jsx(Link,{className:\"link-forgot text-center\",to:\"/forgotPassword\",children:\"Forgot Password ?\"})]})]}),/*#__PURE__*/_jsx(Row,{className:\"message-base justify-content-center align-items-center mb-3\",children:message&&/*#__PURE__*/_jsx(\"small\",{children:message})})]})]})})});}export default Login;","map":{"version":3,"sources":["C:/Users/נריה/Desktop/chat rooms/chatRoomsFrontend/src/chat/Components/Login.js"],"names":["Form","Button","Row","Col","Container","Link","useState","useContext","useHistory","useDispatch","validation","email","password","loginUser","AuthContext","Login","history","dispatch","ctx","login","type","message","setMessage","inValid","value","error","loginInputDetails","setLoginInputDetails","submit","e","preventDefault","isValid","user","key","name","errors","length","response","json","accessToken","ok","setTimeout","refreshToken","push","target","map","index"],"mappings":"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","sourcesContent":["import {Form, Button, Row, Col, Container} from \"react-bootstrap\"\r\nimport {Link} from \"react-router-dom\"\r\nimport {useState, useContext} from \"react\"\r\nimport {useHistory} from \"react-router\"\r\nimport {useDispatch} from \"react-redux\"\r\nimport {validation, email, password} from \"../Utils/validation\"\r\nimport {loginUser} from \"../DAL/authenticationApi\"\r\nimport {AuthContext} from \"../Components/AuthContext\"\r\n\r\n\r\nfunction Login(){\r\n\r\n    const history = useHistory()\r\n    const dispatch = useDispatch()\r\n    const ctx = useContext(AuthContext)\r\n\r\n    const login = () => {\r\n        dispatch({type: 'LOGIN'})\r\n    }\r\n\r\n    const [message, setMessage] = useState(\"\")\r\n    const [loginInputDetails, setLoginInputDetails] = useState({\r\n        email: {...email, inValid: false, value: \"\", error: []},\r\n        password: {...password, inValid: false, value: \"\", error: []}\r\n        })\r\n\r\n        async function submit(e){\r\n            e.preventDefault()\r\n    \r\n            let isValid = true\r\n            let user = {}\r\n    \r\n           for (const key in loginInputDetails) {\r\n    \r\n                user[key] = loginInputDetails[key].value\r\n                setLoginInputDetails(validation({value:loginInputDetails[key].value,name:key},loginInputDetails, \"login\"))\r\n                if (loginInputDetails[key].errors.length !==0){\r\n                    isValid = false\r\n                }\r\n            }\r\n    \r\n            if(isValid){\r\n                const response = await loginUser(user)\r\n                const {accessToken, message} = await response.json()\r\n                setMessage(message)\r\n\r\n                if(response.ok){\r\n                    setTimeout(()=>{\r\n                        ctx.refreshToken(accessToken)\r\n                        login()\r\n                        history.push('/rooms')\r\n                    }, 2000)\r\n                    \r\n                } else {\r\n                    setTimeout(()=>{\r\n                        setMessage(\"\")\r\n                    }, 5000)\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n    return <>\r\n        <Container className=\"container-base mt-4\">\r\n            <Form className=\"form-base\"> \r\n                \r\n                <h1 className=\"text-center mt-3 mb-4\">Login</h1>\r\n                \r\n                <Row className=\"justify-content-center\">\r\n\r\n                    <Col xs={11} md={8} lg={6}>\r\n                        <Form.Group className=\"input-base\">\r\n                            <Form.Control type=\"email\" name=\"email\" isInvalid={loginInputDetails[\"email\"].inValid} placeholder=\"Email\"\r\n                            onBlur={(e)=>{setLoginInputDetails(validation(e.target,loginInputDetails, \"login\"))}}/>\r\n                            {loginInputDetails[\"email\"].errors.map((value,index)=>\r\n                            {return <Form.Control.Feedback className=\"feedback\" key={index} type=\"invalid\"> {value} </Form.Control.Feedback>})}\r\n                        </Form.Group>\r\n\r\n                        <Form.Group className=\"input-base\">\r\n                            <Form.Control type=\"password\" name=\"password\" isInvalid={loginInputDetails[\"password\"].inValid} placeholder=\"Password\"\r\n                            onBlur={(e)=>{setLoginInputDetails(validation(e.target,loginInputDetails, \"login\"))}}/>\r\n                            {loginInputDetails[\"password\"].errors.map((value,index)=>\r\n                            {return <Form.Control.Feedback className=\"feedback\" key={index} type=\"invalid\"> {value} </Form.Control.Feedback>})}\r\n                        </Form.Group>\r\n\r\n                        <Row className=\"btn-link-base mb-3\">\r\n                            <Button className=\"btn-login\" variant=\"dark\" type=\"submit\" onClick={(e)=>{submit(e)}}>\r\n                                Login\r\n                            </Button> \r\n                            <Link className=\"link-forgot text-center\" to=\"/forgotPassword\">Forgot Password ?</Link>\r\n                        </Row>\r\n                       \r\n                    </Col>\r\n\r\n                    <Row className=\"message-base justify-content-center align-items-center mb-3\">\r\n                        {message&&<small>{message}</small>}\r\n                    </Row>\r\n\r\n                </Row>\r\n                \r\n            </Form>\r\n        </Container>\r\n        \r\n    </>\r\n}\r\n\r\nexport default Login"]},"metadata":{},"sourceType":"module"}